version: "3"
tasks:
  build-version:
    cmds:
      - autogit version > settings/version.txt || echo 'not installed autogit' > settings/version.txt

  build:
    cmds:
      - GOOS=linux GOARCH=amd64 go build -v -o main main.go

  test:
    cmds:
      - go test ./... {{.CLI_ARGS}}
    env:
      AUTOGIT_PROJECT_FOLDER:
        sh: echo "$(pwd)"

  doc-web:
    cmds:
      - godoc -http=:6060

  docker:build:
    cmds:
      - docker build --tag darkwind8/darkbot:v0.1.0-a.2 .

  docker:push:
    cmds:
      - docker push darkwind8/darkbot:v0.1.0-a.2

  mkdocs:init:
    cmds:
      - poetry install

  mkdocs:dev:
    cmds:
      - poetry run -- mkdocs serve
